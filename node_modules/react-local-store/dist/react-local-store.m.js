import{createContext as t,useContext as n,useEffect as r,useState as e,createElement as i,Children as o}from"react";var a=t,u=n,c=r,f=e,v="__REACT_LOCAL_STORE__",l=function(t){return Object.assign({},t)},d=window.requestIdleCallback||function(t){var n=Date.now();setTimeout(function(){return t({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-n))}})},1)},m={};function s(t){var n=t.children,r=t.name;void 0===r&&(r=v);var e=t.sync;void 0===e&&(e=!0);var u=t.initialState;void 0===u&&(u={});var s=t.reducer;void 0===s&&(s=l);var g=f(function(){var t=localStorage.getItem(r)||JSON.stringify(u);return localStorage.setItem(r,t),t}),S=g[0],O=g[1],_=JSON.parse(S);return m[r]||(m[r]=a(void 0)),c(function(){if(e){var t=!1;return d(function n(){var e=localStorage.getItem(r);S!==e&&O(e||JSON.stringify(u)),t||d(n)}),function(){t=!0}}},[_]),i(m[r].Provider,{value:[_,function(t){var n=s(_,t),e=JSON.stringify(n);localStorage.setItem(r,e),O(e)}]},o.only(n))}function g(t){return u(m[t||v])}function S(t){return void 0===t&&(t={}),[function(n){return i(s,Object.assign({},n,t))},function(){return g(t.name)}]}export{s as LocalStoreProvider,g as useLocalStore,S as createLocalStore};
